<!DOCTYPE html>


<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <title>Warenkorb</title>
</head>
<body>
<div class="container">
    <div class="row">
        <div class="col-9">
            <h1>Warenkorb</h1>
        </div>
        <div class="col-3">
            <a href="proto.html">Shop</a>
        </div>
    </div>

    <a href="getBasket" id="toBasketButton">Warenkorb</a>
        <a href="home" >To Main Page</a>
        <form action="/updateBasket" method="POST">
            <table id="test">
                <thead>
                    <tr>
                        <th>Items</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
            <input type="submit" value="Update Cart"></input>
        </form>

    <form action="" method="POST">
        <a>Vorname:</a> <br>
        <input type="text" required="required"></input><br>
        <a>Nachname:</a><br>
        <input type="text" required="required"></input><br>
        <a>Email:</a> <br>
        <input type="email" required="required"></input><br>
        <a>Alter:</a> <br> 
        <input type="number" min="18" required="required"><br>
        <input type="submit"></input>
    </form>
</div>
<script type="module">
    var cart = JSON.parse('<%-cart%>');
    console.log(cart[1]);

    console.log(cart);

    var tableRef = document.getElementById('test').getElementsByTagName('tbody')[0];
    var totalPrice = 0;

    for (var i = 0; i < cart.length; i++) {

        totalPrice = totalPrice + cart[i].price * cart[i].count;
        var newRow   = tableRef.insertRow();
        var newCell  = newRow.insertCell(0);
        newCell.innerHTML=cart[i].itemName;
        var newCell  = newRow.insertCell(1);
        newCell.innerHTML=cart[i].price * cart[i].count;
        var newCell  = newRow.insertCell(2);
        newCell.innerHTML="<input type=\"number\" min=\"0\" max= \"10000\"value=" + cart[i].count + " name=Item" + i + "></input>";
}

            var newRow   = tableRef.insertRow();
            var newCell  = newRow.insertCell(0);
            newCell.innerHTML="Total Price =" + totalPrice ;


            var totalPrice = "<%-totalPrice%>";
            var toBasketButton = document.getElementById("toBasketButton");
            toBasketButton.innerHTML="Warenkorb (" + totalPrice +")";
</script>
</body>
</html>